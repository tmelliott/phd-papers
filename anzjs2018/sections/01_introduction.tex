\section{Introduction}
\label{sec:intro}



In public transport, \rt information (RTI), such as estimated times of arrival (ETAs),
keeps transport users informed about their journey,
and potentially make decisions on the best route to take.
It has also been shown that perceived waiting time is less
when arrival time information is available \citep{TCRP_2003b}.
Unfortunately, here in Auckland, RTI is highly unreliable,
and succumbs to several problems that public transport users
are all too familiar with.
One of these is inaccurate ETAs,
which tend to either increase or decrease over time as the bus gets progressively later or earlier
due to traffic congestion, or  because the schedule is poorly calibrated.
Another is that buses are shown as \emph{on-time} if they are not present
in the \rt system,
regardless of whether this is due to technical problems,
or the bus failing to show up;
in either case, schedule times are used to determine ETAs and, 
if the bus doesn't show up on time,
the service is removed from the \rt board 
and we get what passengers have described as ``Ghost Buses''.

Arrival time prediction is only as reliable as the underlying model,
and while a lot of work has gone into developing public transport vehicle models
\citep{Cathey_2003,Jeong_2005,Yu_2011,Hans_2015},
in many public transport systems no formal model is used.
Instead, ETAs are solely based on the scheduled arrival time
adjusted by the vehicle's delay at the most recent stop, if available.
This assumes that the schedule is valid,
and that there is no unusual congestion along the route,
neither of which are valid assumptions,
particularly in our test area of Auckland, New Zealand,
where infrastructure for buses (such as priority lanes) is limited.
This behaviour is exaggerated when there is a large distance between stops,
as the ETA is only updated at stops so there can be a long time between updates.


To avoid the problems discussed above,
a more robust modeling and prediction framework is required.
This should consist of a robust vehicle model to estimate the position and speed
of transit vehicles from \rt GPS data;
and a way to incorporate road congestion information 
into the arrival time predictions.
Several vehicle modeling approaches were explored, 
including the Kalman filter \citep{Dailey_2001,Cathey_2003},
machine learning models \citep{Yu_2006,Chang_2010},
and a particle filter \citep{Hans_2015}.
The last of these was chosen for several reasons
which are discussed in Section~\ref{sec:pf}.

The next step is to construct a method of estimating traffic conditions.
This can be done by using the travel time of preceeding buses along the road
to predict travel times for the current bus.
\cite{Yu_2010} obtained improved prediction accuracy by using travel times
from preceeding buses servicing the same route.
\cite{Hans_2015} used a similar approach,
instead referring to headway, the time between consecutive vehicles
at a point on the route.
However, this approach only works well for high frequency routes.
\cite{Yu_2011} showed further improvements by combining travel times 
from several routes which converged,
but is limited to predefined, converging routes.
In general, however, no comprehensive network modeling approach has been proposed using
solely GPS position data to accounting for congestion when estimating arrival times.
We describe a simple method of constructing a road network
from GTFS data (section~\ref{sec:gtfs}),
which allows all transit vehicles traveling along a road to contribute to tis state,
regardless of which route they are serving.

In this paper, we describe a \rt vehicle and network state
model which uses the vehicles traveling throughout the transit road network
to update congestion information in real-time.
As the vehicle model is implemented using a particle filter,
a computationally intensive method,
we demonstrate its faesibility as a valid real-time option.
The vehicle model provides estimates of travel times along roads,
which can be used to update the road network's state.
Future work is planned to use this travel time information 
in combination with historical data to develop an arrival time prediction model.




